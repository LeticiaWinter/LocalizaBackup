-- MySQL Script generated by MySQL Workbench
-- 03/09/20 04:59:06
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';


-- CUIDADO VAI APAGAR O BANCO EXISTENTE-- 
-- CUIDADO VAI APAGAR O BANCO EXISTENTE-- 
-- CUIDADO VAI APAGAR O BANCO EXISTENTE-- 
-- CUIDADO VAI APAGAR O BANCO EXISTENTE-- 
DROP SCHEMA IF EXISTS `loc` ;


-- -----------------------------------------------------
-- Schema loc
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `loc` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `loc` ;

-- -----------------------------------------------------
-- Table `loc`.`pets`
-- -----------------------------------------------------

CREATE TABLE IF NOT EXISTS `loc`.`pets` (
  `id_pet` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `especie` VARCHAR(10) NOT NULL COMMENT '',
  `raca` VARCHAR(45) NOT NULL COMMENT '',
  `cor_primaria` VARCHAR(15) NOT NULL COMMENT '',
  `cor_secundaria` VARCHAR(15) NOT NULL COMMENT '',
  `sexo` VARCHAR(10) NOT NULL COMMENT '',
  `tipo_pelo` VARCHAR(5) NOT NULL COMMENT '',
  `tamanho` INT NOT NULL COMMENT '',
  `nome` VARCHAR(45) NULL COMMENT '',
  `descricao` VARCHAR(200) NULL COMMENT '',
  `disponivel_adocao` BINARY(1) NULL COMMENT '',
  PRIMARY KEY (`id_pet`)  COMMENT '')
ENGINE = InnoDB;

INSERT INTO `pets` VALUES 
(1,"cao","shih tzu","preto","branco","f","longo",1,NULL,"achada perto da faculdade",0),
(2,"gato","persa","cinza","branco","m","longo",1,NULL,"encontrei no parque da cidade",0), 
(3,"cao","labrador","bege","bege","m","curto",4,"Tuca","fugiu de casa no bairro Bela Vista",1),
(4,"gato","srd","cinza","branco","f","curto",3,"Gaia","usa uma coleira vermelha",1);



-- -----------------------------------------------------
-- Table `loc`.`fotos_pets`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`fotos_pets` (
  `id_foto` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `link_foto` VARCHAR(45) NOT NULL COMMENT '',
  `posicao_foto` INT NOT NULL COMMENT '',
  `id_pet` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_foto`, `id_pet`)  COMMENT '',
  INDEX `fk_fotos_pet_pet_idx` (`id_pet` ASC)  COMMENT '',
  CONSTRAINT `fk_fotos_pet_pet`
    FOREIGN KEY (`id_pet`)
    REFERENCES `loc`.`pets` (`id_pet`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- Inserindo valores
INSERT INTO `fotos_pets` VALUES 
(1,"images/pet/1.jpg",1,1), 
(2,"images/pet/1_2.jpg",2,1), 
(3,"images/pet/1_3.jpg",3,1),
(4,"images/pet/2.jpg",1,2),
(5,"images/pet/2_2.jpg",2,2),
(6,"images/pet/3.jpg",1,3),
(7,"images/pet/4.jpg",1,4),
(8,"images/pet/4_2.jpg",2,4);


-- -----------------------------------------------------
-- Table `loc`.`usuarios`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`usuarios` (
  `id_usuario` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `nome` VARCHAR(45) NOT NULL COMMENT '',
  `cpf` VARCHAR(45) NOT NULL COMMENT '',
  `email` VARCHAR(45) NOT NULL COMMENT '',
  `foto_perfil` VARCHAR(45) NULL COMMENT '',
  `senha` VARCHAR(45) NOT NULL COMMENT '',
  PRIMARY KEY (`id_usuario`)  COMMENT '')
ENGINE = InnoDB;

INSERT INTO `usuarios` VALUES 
(1,"Pedro Henrique","123.456.789-12","pedroh@gmail.com","images/usuario/1.jpg","123456"),
(2,"Maria Eduarda","124.556.769-22","madu@gmail.com","images/usuario/2.jpg","123456"),
(3,"Marco Antônio","523.446.869-16","antonio@gmail.com","images/usuario/3.jpg","123456");


-- -----------------------------------------------------
-- Table `loc`.`alertas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`alertas` (
  `id_alerta` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `tipo_alerta` VARCHAR(10) NOT NULL COMMENT '',
  `created_at` DATE NOT NULL COMMENT '',
  `id_match` INT NULL COMMENT '',
  `alerta_encerrado_match` BINARY(1) NOT NULL COMMENT '',
  `alerta_encerrado_delete` BINARY(1) NOT NULL COMMENT '',
  `data_encerrado` DATE NULL COMMENT '',
  `id_usuario` INT NOT NULL COMMENT '',
  `id_pet` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_alerta`, `id_usuario`, `id_pet`)  COMMENT '',
  INDEX `fk_alertas_usuario1_idx` (`id_usuario` ASC)  COMMENT '',
  INDEX `fk_alertas_pet1_idx` (`id_pet` ASC)  COMMENT '',
  CONSTRAINT `fk_alertas_usuario1`
    FOREIGN KEY (`id_usuario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_alertas_pet1`
    FOREIGN KEY (`id_pet`)
    REFERENCES `loc`.`pets` (`id_pet`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO `alertas` VALUES 
(1,"achado","2020/04/03 17:55:00",NULL,0,1,"2020/04/03 18:55:00",1,1),
(2,"achado","2020/02/01 12:56:00", NULL,0,0,NULL,2,2), 
(3,"perdido","2020/04/03 11:36:00",NULL,0,0,NULL,3,3),
(4,"perdido","2020/03/28 10:16:00",5,1,0,"2020/03/29 10:16:00",1,4),
(5,"achado","2020/03/29 10:16:00",4,1,0,"2020/03/29 10:16:00",1,4);

-- -----------------------------------------------------
-- Table `loc`.`geo_localizacao`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`geo_localizacao` (
  `id_localizacao` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `latitude` FLOAT NOT NULL COMMENT '',
  `longitude` FLOAT NOT NULL COMMENT '',
  `updated_at` DATE NOT NULL COMMENT '',
  `id_alerta` INT NOT NULL COMMENT '',
  `id_usuario` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_localizacao`, `id_alerta`, `id_usuario`)  COMMENT '',
  INDEX `fk_geo_localizacao_alertas1_idx` (`id_alerta` ASC)  COMMENT '',
  INDEX `fk_geo_localizacao_usuario1_idx` (`id_usuario` ASC)  COMMENT '',
  CONSTRAINT `fk_geo_localizacao_alertas1`
    FOREIGN KEY (`id_alerta`)
    REFERENCES `loc`.`alertas` (`id_alerta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_geo_localizacao_usuario1`
    FOREIGN KEY (`id_usuario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- Inserindo valores
INSERT INTO `geo_localizacao` VALUES 
(1,-25.432,42.3243,"2020/04/03 05:55:00",1,1), 
(2,-25.432,42.3,"2020/02/01 12:56:00",2,2), 
(3,-25.2,41.3243,"2020/04/03 11:36:00",3,3), 
(4,-20.432,48.2,"2020/03/28 10:16:00",4,1);

-- -----------------------------------------------------
-- Table `loc`.`comentarios`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`comentarios` (
  `id_comentario` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `comentario` VARCHAR(200) NOT NULL COMMENT '',
  `created_at` DATE NOT NULL COMMENT '',
  `id_alerta` INT NOT NULL COMMENT '',
  `id_usuario` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_comentario`, `id_alerta`, `id_usuario`)  COMMENT '',
  INDEX `fk_comentarios_alertas1_idx` (`id_alerta` ASC)  COMMENT '',
  INDEX `fk_comentarios_usuario1_idx` (`id_usuario` ASC)  COMMENT '',
  CONSTRAINT `fk_comentarios_alertas1`
    FOREIGN KEY (`id_alerta`)
    REFERENCES `loc`.`alertas` (`id_alerta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_comentarios_usuario1`
    FOREIGN KEY (`id_usuario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO `comentarios` VALUES 
(1,"Primeiro comentário","2020/04/04 01:55:00",1,3), 
(2,"Iniciou o chat","2020/02/02 13:56:00",2,2), 
(3,"Outro comentário","2020/04/03 11:36:00",3,3), 
(4,"Encerrou o chat","2020/03/28 10:16:00",4,1);


-- -----------------------------------------------------
-- Table `loc`.`chats`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`chats` (
  `id_chats` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `id_alerta` INT NOT NULL COMMENT '',
  `created_at` DATE NOT NULL COMMENT '',
  `chat_encerrado` BINARY(1) NOT NULL COMMENT '',
  `id_usuario_primario` INT NOT NULL COMMENT '',
  `id_usuario_secundario` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_chats`, `id_usuario_primario`, `id_usuario_secundario`)  COMMENT '',
  INDEX `fk_chats_usuario1_idx` (`id_usuario_primario` ASC)  COMMENT '',
  INDEX `fk_chats_usuario2_idx` (`id_usuario_secundario` ASC)  COMMENT '',
  CONSTRAINT `fk_chats_usuario1`
    FOREIGN KEY (`id_usuario_primario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_chats_usuario2`
    FOREIGN KEY (`id_usuario_secundario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `loc`.`mensagens`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `loc`.`mensagens` (
  `id_mensagens` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `mensagem` VARCHAR(200) NOT NULL COMMENT '',
  `send_at` DATE NOT NULL COMMENT '',
  `id_usuario` INT NOT NULL COMMENT '',
  `id_chats` INT NOT NULL COMMENT '',
  PRIMARY KEY (`id_mensagens`, `id_usuario`, `id_chats`)  COMMENT '',
  INDEX `fk_mensagens_usuario1_idx` (`id_usuario` ASC)  COMMENT '',
  INDEX `fk_mensagens_chats1_idx` (`id_chats` ASC)  COMMENT '',
  CONSTRAINT `fk_mensagens_usuario1`
    FOREIGN KEY (`id_usuario`)
    REFERENCES `loc`.`usuarios` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_mensagens_chats1`
    FOREIGN KEY (`id_chats`)
    REFERENCES `loc`.`chats` (`id_chats`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;